<!-- Placeholder #main -->
<!-- Prevents Uncaught TypeError: Cannot read property 'append' of null error -->
<div id="main"></div>
<script src="simpletest.js"></script>
<script src="helper.js"></script>
<script src="../scripts.js"></script>
<script>

  // Destructure variables so they are easier to access:
  var todoList = nestedTodos.todoList;
  var add = todoList.add;
  var edit = todoList.edit;
  var remove = todoList.remove;
  var toggle = todoList.toggle;

  /*

  Purpose of adding <p> to markup:
  1. The paragraph tag makes the markup of the document more semantic.
  2. The textContent of an element can more accurately be queried because all text is now within a <p>.
  3. The text-decoration: line-through; style can now be applied to <p> elements only and will not affect all descendant elements.

  Requirements to be re-evaluated in sections.
  Sections of view tests to be re-evaluated in the following order.

  1. Basic todos. (Old tests 1-5)
  2. Nested todos. (Old tests 6-9)
  3. Nested todo in nested todo. (Old tests 10-11)
  4. Text and id values of elements. (Old tests 12-15)
  5. Functions other than add(). (Old tests 16-20)
  6. CSS markup. (Remove margins from <p> elements in CSS file)

  */

  // New tests with <p>:
  tests({
    // Phase 1: Construct markup that will hold nested todos.
    // When application has loaded:
    "1) If todos.length === 0, main.children[0].tagName should be 'DIV'.": function () {
      var main = document.querySelector('#main');

      eq(main.children[0].tagName, "DIV");
    },
    // First todo <ul>:
    "2) If todos.length === 1, div.children[0].tagName should be 'UL'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var div = main.children[0];

      eq(div.children[0].tagName, "UL");
      resetAfterTest();
    },
    // First todo <li>:
    "3) If todos.length === 1, ul.children[0].tagName should be 'LI'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].tagName, "LI");
      resetAfterTest();
    },
    /*

    Remaining basic todo tests:
    4. First todo <p>:
    If todos.length === 1, ul.children[0].children[0].tagName should be 'P'.
    <div>
      <ul>
        <li>
          <p></p>
        </li>
      </ul>
    </div>

    5. Todos.length > 1:
    If todos.length === 2, ul.children[1].children[0].tagName should be 'P'.
    <div>
      <ul>
        <li>
          <p></p>
        </li>
        <li>
          <p></p>
        </li>
      </ul>
    </div>

    */
    // First todo <p>:
    "4) If todos.length === 1, ul.children[0].children[0].tagName should be 'P'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].children[0].tagName, "P");
      resetAfterTest();
    }
  });

  /*
  // Old tests without <p>:
  tests({
    // Phase 1: Construct markup that will hold nested todos.
    // When application has loaded:
    "1) If todos.length === 0, main.children[0].tagName should be 'DIV'.": function () {
      var main = document.querySelector('#main');

      eq(main.children[0].tagName, "DIV");
    },
    // Basic todo:
    "2) If todos.length === 1, div.children[0].tagName should be 'UL'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var div = main.children[0];

      eq(div.children[0].tagName, "UL");
      resetAfterTest();
    },
    // Add first todo:
    "3) If todos.length === 1, ul.children[0].tagName should be 'LI'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].tagName, "LI");
      resetAfterTest();
    },
    // Set todos.length > 1:
    "4) If todos.length === 2, ul.children[1].tagName should be 'LI'.": function(){
      add('1st', []);
      add('2nd', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[1].tagName, "LI");
      resetAfterTest();
    },
    // One more, just to be sure.
    // Test passed without writing additional code. Kept for documentation.
    "5) If todos.length === 3, ul.children[2].tagName should be 'LI'.": function(){
      add('1st', []);
      add('2nd', []);
      add('3rd', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[2].tagName, "LI");
      resetAfterTest();
    },
    // Check for <ul> in nested todo:
    "6) If todos[0].todos.length === 1, ul.children[0].children[0].tagName should be 'UL'.": function(){
      add('1st', []);
      add('1st nested', [0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].children[0].tagName, "UL");
      resetAfterTest();
    },
    // Check for <li> in nested todo:
    "7) If todos[0].todos.length === 1, ul.children[0].children[0].children[0].tagName should be 'LI'.": function(){
      add('1st', []);
      add('1st nested', [0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].children[0].children[0].tagName, "LI");
      resetAfterTest();
    },
    // Change index of nested todo:
    // Test passed without writing additional code. Kept for documentation.
    "8) If todos[1].todos.length === 1, ul.children[1].children[0].children[0].tagName should be 'LI'.": function(){
      add('1st', []);
      add('2nd', []);
      add('1st nested', [1]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[1].children[0].children[0].tagName, "LI");
      resetAfterTest();
    },
    // Set nested todos.length > 0:
    "9) If todos[1].todos.length === 2, ul.children[1].children[0].children[1].tagName should be 'LI'.": function(){
      add('1st', []);
      add('2nd', []);
      add('1st nested', [1]);
      add('2nd nested', [1]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[1].children[0].children[1].tagName, "LI");
      resetAfterTest();
    },
    // Check for <ul> in nested todo in nested todo:
    "10) If todos[0].todos[0].todos.length === 1, ul.children[0].children[0].children[0].children[0].tagName should be 'UL'.": function(){
      add('1st', []);
      add('1st nested', [0]);
      add('1st nested in nested', [0,0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].children[0].children[0].children[0].tagName, "UL");
      resetAfterTest();
    },
    // Check for <li> in nested todo in nested todo:
    "11) If todos[0].todos[0].todos.length === 1, ul.children[0].children[0].children[0].children[0].children[0].tagName should be 'LI'.": function(){
      add('1st', []);
      add('1st nested', [0]);
      add('1st nested in nested', [0,0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].children[0].children[0].children[0].children[0].tagName, "LI");
      resetAfterTest();
    },

    // -------------------------------

    // Phase 2: Pass text and id values to todos.
    // Add text to a todo:
    "12) If todos[0].text === '1st', ul.children[0].textContent should be '1st'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].textContent, '1st');
      resetAfterTest();
    },
    // Check text of different todo to be sure:
    // Test passed without writing additional code. Kept for documentation.
    "13) If todos[1].text === '2nd', ul.children[1].textContent should be '2nd'.": function(){
      add('1st', []);
      add('2nd', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[1].textContent, '2nd');
      resetAfterTest();
    },
    // Add id value to a todo:
    "14) If todos[0] exists, then ul.children[0].id should be '0'.": function(){
      add('1st', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].id, '0');
      resetAfterTest();
    },
    // Check id value of different todo to be sure:
    // Test passed without writing additional code. Kept for documentation.
    "15) If todos[1] exists, then ul.children[1].id should be '1'.": function(){
      add('1st', []);
      add('2nd', []);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[1].id, '1');
      resetAfterTest();
    },

    // -------------------------------

    // Phase 3: Modify markup appropriately after remove(), toggle() and edit().
    // Basic remove:
    "16) If todos.length === 1 and remove([0]) is called, div.children.length should be 0.": function(){
      add('1st', []);
      remove([0]);
      var main = document.querySelector('#main');
      var div = main.children[0];

      eq(div.children.length, 0);
      resetAfterTest();
    },
    // Basic toggle, not completed to completed:
    "17) If todos[0].completed === false and toggle([0]) is called, ul.children[0].className should be 'completed'.": function(){
      add('1st', []);
      toggle([0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].className, 'completed');
      resetAfterTest();
    },
    // Basic toggle, completed to not completed:
    // Test passed without writing additional code. Kept for documentation.
    "18) If todos[0].completed === true and toggle([0]) is called, ul.children[0].className should be ''.": function(){
      add('1st', []);
      toggle([0]);
      toggle([0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].className, '');
      resetAfterTest();
    },
    // Basic edit that modifies text of existing todo:
    "19) If todos[0].text === '1st' and edit('first', [0]), ul.children[0].textContent should be 'first'.": function(){
      add('1st', []);
      edit('first', [0]);
      var main = document.querySelector('#main');
      var ul = main.children[0].children[0];

      eq(ul.children[0].textContent, 'first');
      resetAfterTest();
    },
    // Basic edit that deletes existing todo:
    // Test passed without writing additional code. Kept for documentation.
    "20) If todos[0].text === '1st' and edit('', [0]), div.children.length should be 0.": function(){
      add('1st', []);
      edit('', [0]);
      var main = document.querySelector('#main');
      var div = main.children[0];

      eq(div.children.length, 0);
      resetAfterTest();
    }
  });
  */
</script>