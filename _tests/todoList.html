<script src="simpletest.js"></script>
<script src="../scripts.js"></script>
<script>
  /*

  Requirements strategy for Nested todos data structure:

  Phase 1: Basic todos
  a) It should have a place to store todos.
  b) It should have a way to display todos.
  c) It should have a way to add new todos.

  Phase 2: Basic nested todos
  a) It should have a place to store nested todos.
  b) It should have a way to display nested todos.
  c) It should have a way to add nested todos.

  Phase 3: Removal of todos and nested todos:
  a) It should have a way to remove a todo.
  b) It should have a way to remove a nested todo.

  Phase 4: Editing of text for todos and nested todos:
  a) If the text after editing is "", it should remove the todo.
  b) If the text after editing is !== "", it should have a way to edit the text of the todo.
  c) If the text after editing is !== "", it should have a way to edit the text of the nested todo.

  Phase 5: Editing of the completed status of todos and nested todos:
  a) It should have todos with a completed status.
  b) It should have a way to edit the completed status of a todo.
  c) It should have a way to edit the completed status a nested todo.

  TODO: Consider adding a Phase 6:
  Should errors be thrown if the todo that the function suggests should be modified does not exist.

  ----------------------------

  */

  // Reminder: Write note about deleting tests if you don't need to add any new code to pass them.

  // Destructure variables so they are easier to access:
  var todoList = nestedTodos.todoList;
  var add = todoList.add;
  var edit = todoList.edit;
  var remove = todoList.remove;

  // Helper function to set todoList.todos to [] after each test:
  function emptyTodos(){
    nestedTodos.todoList.todos = [];
  }

  tests({
    // Phase 1:
    // It should have a way to store todos.
    "1) If the application has just loaded, todos should be [].": function () {
      var todos = nestedTodos.todoList.todos;
      eq(Array.isArray(todos), true);
      eq(todos.length, 0);

      emptyTodos();
    },
    // It should have a way to add new todos:
    "2) If todos.length === 0 and then add('1st', []), then todos[0] should be {text:'1st', todos: []}.": function () {
      add('1st', []);

      // Check number of todos:
      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      // Check shape of first todo:
      var firstTodo = todos[0];
      eq(firstTodo.text, '1st');
      eq(Array.isArray(firstTodo.todos), true);
      eq(firstTodo.todos.length, 0);

      emptyTodos();
    },

    // Phase 2: Nested todos.
    // Nest a single todo within the first todo:
    "3) If todos[0].todos.length === 0 and then add('Nested', [0]), todos[0].todos[0] should be {text:'Nested', todos:[]}.": function () {
      add('1st', []);
      add('Nested', [0]);

      // Check parent todo has a nested todo:
      var parentTodo = nestedTodos.todoList.todos[0];
      eq(parentTodo.todos.length, 1);
      // Check shape of nested todo:
      var nestedTodo = parentTodo.todos[0];
      eq(nestedTodo.text, "Nested");
      eq(Array.isArray(nestedTodo.todos), true);
      eq(nestedTodo.todos.length, 0);

      emptyTodos();
    },
    // Nest a single todo within the second todo:
    "4) If todos[1].todos.length === 0 and then add('Nested', [1]), todos[1].todos[0] should be {text:'Nested', todos:[]}.": function () {
      add('1st', []);
      add('2nd', []);
      add('Nested', [1]);

      // Check parent todo has a nested todo:
      var parentTodo = nestedTodos.todoList.todos[1];
      eq(parentTodo.todos.length, 1);
      // Check shape of nested todo:
      var nestedTodo = parentTodo.todos[0];
      eq(nestedTodo.text, "Nested");
      eq(Array.isArray(nestedTodo.todos), true);
      eq(nestedTodo.todos.length, 0);

      emptyTodos();
    },
    // Nest a todo more than one layer deep:
    "5) If todos[0].todos[0].length === 1 and then add('Nested in nested', [0,0]), todos[0].todos[0].todos[0] should be {text:'Nested in nested', todos:[]}.": function(){
      add('1st', []);
      add('Nested', [0]);
      add('Nested in nested', [0,0]);

      // Check parent todo has a nested todo:
      var parentTodo = nestedTodos.todoList.todos[0].todos[0];
      eq(parentTodo.todos.length, 1);
      // Check shape of nested todo:
      var nestedTodo = parentTodo.todos[0];
      eq(nestedTodo.text, "Nested in nested");
      eq(Array.isArray(nestedTodo.todos), true);
      eq(nestedTodo.todos.length, 0);

      emptyTodos();
    },
    // Stress test the nested todos feature:
    "6) If todos[3].todos[0].todos[2].todos.length === 1, and then add('2nd nested stress', [3, 0, 2]), todos[3].todos[0].todos[2].todos[1] should be {text:'2nd nested stress', todos:[]}.": function(){
      add('1st', []);
      add('2nd', []);
      add('3rd', []);
      add('4th', []);
      add('1st Nested', [3]);
      add('1st nested in nested', [3, 0]);
      add('2nd nested in nested', [3, 0]);
      add('3rd nested in nested', [3, 0]);
      add('1st nested stress', [3, 0, 2]);
      add('2nd nested stress', [3, 0, 2]);

      // Check parent todo has a nested todo:
      var parentTodo = nestedTodos.todoList.todos[3].todos[0].todos[2];
      eq(parentTodo.todos.length, 2);
      // Check shape of nested todo:
      var nestedTodo = parentTodo.todos[1];
      eq(nestedTodo.text, "2nd nested stress");
      eq(Array.isArray(nestedTodo.todos), true);
      eq(nestedTodo.todos.length, 0);

      emptyTodos();
    },

    // Phase 3: Removal of todos.
    // It should have a way to remove a todo.
    // Basic todo.
    "7) If todos.length === 1, remove([0]) should remove the 1st index in todos.": function () {
      add('1st', []);
      remove([0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Change todos.length.
    "8) If todos.length === 2, remove([0]) should remove the 1st index in todos.": function(){
      // Passed without additional code. Consider deleting.
      add('1st', []);
      add('2nd', []);
      remove([0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "2nd");

      emptyTodos();
    },
    // Change todos[i].
    "9) If todos.length === 2, remove([1]) should remove the 2nd index in todos.": function(){
      add('1st', []);
      add('2nd', []);
      remove([1]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "1st");

      emptyTodos();
    },
    // It should have a way to remove a nested todo.
    // Basic test:
    "10) If todos.length === 1 and todos[0].todos.length === 1, remove([0,0]) should remove the 1st index in todos[0].todos. ": function(){
      add('1st', []);
      add('Nested', [0]);
      remove([0, 0]);

      var todos = nestedTodos.todoList.todos[0].todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Change todos.length:
    "11) If todos.length === 2 and todos[0].todos.length === 1, remove([0,0]) should remove the 1st index in todos[0].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('Nested', [0]);
      remove([0, 0]);

      var todos = nestedTodos.todoList.todos[0].todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Change todos[i]:
    "12) If todos.length === 2 and todos[1].todos.length === 1, remove([1,0]) should remove the 1st index in todos[1].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('Nested', [1]);
      remove([1, 0]);

      var todos = nestedTodos.todoList.todos[1].todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Change todos[i].todos.length:
    "13) If todos.length === 2 and todos[1].todos.length === 2, remove([1,0]) should remove the 1st index in todos[1].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('1st nested', [1]);
      add('2nd nested', [1]);
      remove([1, 0]);

      var todos = nestedTodos.todoList.todos[1].todos;
      eq(todos.length, 1);
      eq(todos[0].text, '2nd nested');

      emptyTodos();
    },
    // Change todos.[i].todos[i]
    "14) If todos.length === 2 and todos[1].todos.length === 2, remove([1,1]) should remove the 2nd index in todos[1].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('1st nested', [1]);
      add('2nd nested', [1]);
      remove([1, 1]);

      var todos = nestedTodos.todoList.todos[1].todos;
      eq(todos.length, 1);
      eq(todos[0].text, '1st nested');

      emptyTodos();
    },
    // Nest an additional layer:
    "15) If todos.length === 2, todos[1].todos.length === 2 and todos[1].todos[1].todos.length === 1, remove([1,1,0]) should remove the the 1st index in todos[1].todos[1].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('1st nested', [1]);
      add('2nd nested', [1]);
      add('Nested in nested', [1,1]);
      remove([1,1,0]);

      var todos = nestedTodos.todoList.todos[1].todos[1].todos
      eq(todos.length, 0);

      emptyTodos();
    },
    // Stress test:
    "16) If todos[3].todos[0].todos[2].todos.length === 2, remove([3,0,2,1]), should remove the 2nd index in todos[3].todos[0].todos[2].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('3rd', []);
      add('4th', []);
      add('1st Nested', [3]);
      add('1st nested in nested', [3, 0]);
      add('2nd nested in nested', [3, 0]);
      add('3rd nested in nested', [3, 0]);
      add('1st nested stress', [3, 0, 2]);
      add('2nd nested stress', [3, 0, 2]);
      remove([3, 0, 2, 1]);

      var todos = nestedTodos.todoList.todos[3].todos[0].todos[2].todos;
      eq(todos.length, 1);
      eq(todos[0].text, "1st nested stress");

      emptyTodos();
    },
    // Phase 4: Editing of text for todos and nested todos.
    // If the text.length === 0, it should remove the todo.
    // Basic test:
    "17) If todos.length === 1, edit('', [0]) should remove the 1st index from todos.": function(){
      add('1st', []);
      edit('', [0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Change todos.length:
    "18) If todos.length === 2, edit('', [0]) should remove the 1st index from todos.": function(){
      // Passed without additional code. Consider removing.
      add('1st', []);
      add('2nd', []);
      edit('', [0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "2nd");

      emptyTodos();
    },
    // Change indicies[0]:
    "19) If todos.length === 2, edit('', [1]) should remove the 2nd index from todos.": function(){
      add('1st', []);
      add('2nd', []);
      edit('', [1]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "1st");

      emptyTodos();
    },
    // For documentation purposes. Passed without additional code being written:
    "20) If todos[0].todos.length === 1, edit('', [0,0]) should remove the 1st index from todos[0].todos.": function(){
      add('1st', []);
      add('Nested', [0]);
      edit('', [0,0]);

      var todos = nestedTodos.todoList.todos[0].todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // For documentation purposes. Passed without additional code being written:
    "21) If todos[0].todos[0].todos.length === 1, edit('', [0,0,0]) should remove the 1st index from todos[0].todos[0].todos.": function(){
      add('1st', []);
      add('Nested', [0]);
      add('Nested in nested', [0,0]);
      edit('', [0,0,0]);

      var todos = nestedTodos.todoList.todos[0].todos[0].todos;
      eq(todos.length, 0);

      emptyTodos();
    },
    // Stress test:
    "22) If todos[3].todos[0].todos[2].todos.length === 2, edit('', [3,0,2,1]), should remove the 2nd index in todos[3].todos[0].todos[2].todos.": function(){
      add('1st', []);
      add('2nd', []);
      add('3rd', []);
      add('4th', []);
      add('1st Nested', [3]);
      add('1st nested in nested', [3, 0]);
      add('2nd nested in nested', [3, 0]);
      add('3rd nested in nested', [3, 0]);
      add('1st nested stress', [3, 0, 2]);
      add('2nd nested stress', [3, 0, 2]);
      edit('', [3, 0, 2, 1]);

      var todos = nestedTodos.todoList.todos[3].todos[0].todos[2].todos;
      eq(todos.length, 1);
      eq(todos[0].text, "1st nested stress");

      emptyTodos();
    },
    /*

    Phase 4: Editing of text for todos and nested todos.
    a) If the text after editing is "", it should remove the todo.
    b) If the text after editing is !== "", it should have a way to edit the text of the todo.
    c) If the text after editing is !== "", it should have a way to edit the text of the nested todo.

    a - completed
    b & c - unfinished

    Different ways the todo can be edited:
    1) If the text.length === 0, it should remove the todo.
    2) If the text.length > 0, it should update the text in the todo.

    Variables:
    1) Text being passed to edit().
    2) Number of todos in list of todos being modified.
    3) Index of todo being modified.
    4) Level of nesting. (1st layer, 2nd layer, 3rd layer).

    If the text.length > 0:
    1) If todos[0].text === "1st" && todos.length === 1, edit('First', [0]) should set todos[0].text to "First".
    2) If todos[0].text === "1st" && todos.length === 1, edit('Different first', [0]) should set todos[0].text to "Different first".
    3) If todos[0].text === "1st" && todos.length === 2, edit('Different first', [0]) should set todos[0].text to "Different first".
    4) If todos[1].text === "2nd" && todos.length === 2, edit('Different second', [1]) should set todos[1].text to "Different second".

    */

    // If the text.length > 0, it should edit the todo.
    // Basic test:
    "23) If todos[0].text === '1st' && todos.length === 1, edit('First', [0]) should set todos[0].text to 'First'.": function(){
      add('1st', []);
      edit('First', [0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "First");

      emptyTodos();
    },
    // Change text being passed to edit():
    "24) If todos[0].text === '1st' && todos.length === 1, edit('Different first', [0]) should set todos[0].text to 'Different first'." : function(){
      add('1st', []);
      edit('Different first', [0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 1);
      eq(todos[0].text, "Different first");

      emptyTodos();
    },
    // Change length of todos:
    "25) If todos[0].text === '1st' && todos.length === 2, edit('Different first', [0]) should set todos[0].text to 'Different first'.":function(){
      add('1st', []);
      add('2nd', []);
      edit('Different first', [0]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 2);
      eq(todos[0].text, "Different first");

      emptyTodos();
    },
    // Change index of todo being modified:
    "26) If todos[1].text === '2nd' && todos.length === 2, edit('Different second', [1]) should set todos[1].text to 'Different second'.": function(){
      add('1st', []);
      add('2nd', []);
      edit('Different second', [1]);

      var todos = nestedTodos.todoList.todos;
      eq(todos.length, 2);
      eq(todos[1].text, "Different second");

      emptyTodos();
    }

  });
</script>